<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 生物学常用工具 | 生物信息学项目驱动实战</title>
  <meta name="description" content="4 生物学常用工具 | 生物信息学项目驱动实战" />
  <meta name="generator" content="bookdown 0.11 and GitBook 2.6.7" />

  <meta property="og:title" content="4 生物学常用工具 | 生物信息学项目驱动实战" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 生物学常用工具 | 生物信息学项目驱动实战" />
  
  
  

<meta name="author" content="碱基吃柠檬" />


<meta name="date" content="2019-07-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="biodata.html">
<link rel="next" href="art-of-ctrl-c-and-ctrl-v.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- for Facebook -->  
<meta property="og:url" content="https://github.com/sdbiodog" />
<meta property="og:description" content="本项目是将github上经典的scRNA-seq分析教程进行汉化，源项目参见hemberg-lab/scRNA.seq.course" />
<meta property="og:image" content="http://hemberg-lab.github.io/scRNA.seq.course/figures/RNA-Seq_workflow-5.pdf.jpg" />

<!-- for Twitter -->          
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="scRNA-seq数据分析" />
<meta name="twitter:description" content="本项目是将github上经典的scRNA-seq分析教程进行汉化，源项目参见hemberg-lab/scRNA.seq.course" />
<meta name="twitter:image" content="http://hemberg-lab.github.io/scRNA.seq.course/figures/RNA-Seq_workflow-5.pdf.jpg" />

<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-71525309-1', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Table of Contents</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 说在前面的话</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#section-1.1"><i class="fa fa-check"></i><b>1.1</b> 关于本项目</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#section-1.2"><i class="fa fa-check"></i><b>1.2</b> 许可</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#section-1.3"><i class="fa fa-check"></i><b>1.3</b> 准备知识</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#section-1.4"><i class="fa fa-check"></i><b>1.4</b> 排版约定</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#section-1.5"><i class="fa fa-check"></i><b>1.5</b> 联系我们</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="hardware-sorftware-and-basics.html"><a href="hardware-sorftware-and-basics.html"><i class="fa fa-check"></i><b>2</b> 硬件，软件，与基础</a><ul>
<li class="chapter" data-level="2.1" data-path="hardware-sorftware-and-basics.html"><a href="hardware-sorftware-and-basics.html#section-2.1"><i class="fa fa-check"></i><b>2.1</b> 几个问题</a><ul>
<li class="chapter" data-level="2.1.1" data-path="hardware-sorftware-and-basics.html"><a href="hardware-sorftware-and-basics.html#linuxwindows"><i class="fa fa-check"></i><b>2.1.1</b> Linux还是Windows?</a></li>
<li class="chapter" data-level="2.1.2" data-path="hardware-sorftware-and-basics.html"><a href="hardware-sorftware-and-basics.html#matlabpythonr"><i class="fa fa-check"></i><b>2.1.2</b> 可以使用Matlab来替代python或者是R吗？</a></li>
<li class="chapter" data-level="2.1.3" data-path="hardware-sorftware-and-basics.html"><a href="hardware-sorftware-and-basics.html#section"><i class="fa fa-check"></i><b>2.1.3</b> </a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="hardware-sorftware-and-basics.html"><a href="hardware-sorftware-and-basics.html#section-2.2"><i class="fa fa-check"></i><b>2.2</b> 基本环境</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="biodata.html"><a href="biodata.html"><i class="fa fa-check"></i><b>3</b> 生物数据</a><ul>
<li class="chapter" data-level="3.1" data-path="biodata.html"><a href="biodata.html#section-3.1"><i class="fa fa-check"></i><b>3.1</b> 常用生物数据库</a></li>
<li class="chapter" data-level="3.2" data-path="biodata.html"><a href="biodata.html#section-3.2"><i class="fa fa-check"></i><b>3.2</b> 常见生物数据格式</a><ul>
<li class="chapter" data-level="3.2.1" data-path="biodata.html"><a href="biodata.html#section-3.2.1"><i class="fa fa-check"></i><b>3.2.1</b> 生物数据下载</a></li>
<li class="chapter" data-level="3.2.2" data-path="biodata.html"><a href="biodata.html#section-3.2.2"><i class="fa fa-check"></i><b>3.2.2</b> 数据格式转换</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="biotools.html"><a href="biotools.html"><i class="fa fa-check"></i><b>4</b> 生物学常用工具</a><ul>
<li class="chapter" data-level="4.1" data-path="biotools.html"><a href="biotools.html#aligner"><i class="fa fa-check"></i><b>4.1</b> Aligner</a><ul>
<li class="chapter" data-level="4.1.1" data-path="biotools.html"><a href="biotools.html#section-4.1.1"><i class="fa fa-check"></i><b>4.1.1</b> 参考基因组选择</a></li>
<li class="chapter" data-level="4.1.2" data-path="biotools.html"><a href="biotools.html#section-4.1.2"><i class="fa fa-check"></i><b>4.1.2</b> 构建索引</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="art-of-ctrl-c-and-ctrl-v.html"><a href="art-of-ctrl-c-and-ctrl-v.html"><i class="fa fa-check"></i><b>5</b> 项目1一单细胞数据分析实战</a><ul>
<li class="chapter" data-level="5.1" data-path="art-of-ctrl-c-and-ctrl-v.html"><a href="art-of-ctrl-c-and-ctrl-v.html#section-5.1"><i class="fa fa-check"></i><b>5.1</b> 单细胞分析流程学习</a></li>
<li class="chapter" data-level="5.2" data-path="art-of-ctrl-c-and-ctrl-v.html"><a href="art-of-ctrl-c-and-ctrl-v.html#section-5.2"><i class="fa fa-check"></i><b>5.2</b> 文章重复</a><ul>
<li class="chapter" data-level="5.2.1" data-path="art-of-ctrl-c-and-ctrl-v.html"><a href="art-of-ctrl-c-and-ctrl-v.html#single-cell-transcriptomics-of-human-and-mouse-lung-cancers-reveals-conserved-myeloid-populations-across-individuals-and-species"><i class="fa fa-check"></i><b>5.2.1</b> 标题：Single-Cell Transcriptomics of Human and Mouse Lung Cancers Reveals Conserved Myeloid Populations across Individuals and Species</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/lemonbases/scRNA.seq.course.CN" target="blank">碱基吃柠檬</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">生物信息学项目驱动实战</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="biotools" class="section level1">
<h1><span class="header-section-number">4</span> 生物学常用工具</h1>
<div id="aligner" class="section level2">
<h2><span class="header-section-number">4.1</span> Aligner</h2>
<ul>
<li>Bowtie</li>
<li>HiSAT2</li>
<li>STAR</li>
<li>BWA</li>
<li>…</li>
</ul>
<div class="figure">
<img src="https://www.ecseq.com/support/ngs/img/ngs_read_mappers_timeline.jpeg" alt="Mappers Timeline" />
<p class="caption">Mappers Timeline</p>
</div>
<div id="section-4.1.1" class="section level3">
<h3><span class="header-section-number">4.1.1</span> 参考基因组选择</h3>
<p>If you map reads to GRCh37 or hg19, use <code>hs37-1kg</code>:</p>
<pre><code>ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/technical/reference/human_g1k_v37.fasta.gz</code></pre>
<p>If you map to GRCh37 and believe decoy sequences help with better variant calling, use <code>hs37d5</code>:</p>
<pre><code>ftp://ftp-trace.ncbi.nih.gov/1000genomes/ftp/technical/reference/phase2_reference_assembly_sequence/hs37d5.fa.gz</code></pre>
<p>If you map reads to GRCh38 or hg38, use the following:</p>
<pre><code>ftp://ftp.ncbi.nlm.nih.gov/genomes/all/GCA/000/001/405/GCA_000001405.15_GRCh38/seqs_for_alignment_pipelines.ucsc_ids/GCA_000001405.15_GRCh38_no_alt_analysis_set.fna.gz</code></pre>
<p>There are several other versions of GRCh37/GRCh38. What’s wrong with them? Here are a collection of potential issues:</p>
<ol style="list-style-type: decimal">
<li><p>Inclusion of ALT contigs. ALT contigs are large variations with very long flanking sequences nearly identical to the primary human assembly. Most read mappers will give mapping quality zero to reads mapped in the flanking sequences. This will reduce the sensitivity of variant calling and many other analyses. You can resolve this issue with an ALT-aware mapper, but no mainstream variant callers or other tools can take the advantage of ALT-aware mapping.</p></li>
<li><p>Padding ALT contigs with long “N”s. This has the same problem with 1 and also increases the size of genome unnecessarily. It is worse.</p></li>
<li><p>Inclusion of multi-placed sequences. In both GRCh37 and GRCh38, the pseudo-autosomal regions (PARs) of chrX are also placed on to chrY. If you use a reference genome that contains both copies, you will not be able to call any variants in PARs with a standard pipeline. In GRCh38, some alpha satellites are placed multiple times, too. The right solution is to hard mask PARs on chrY and those extra copies of alpha repeats.</p></li>
<li><p>Not using the rCRS mitochondrial sequence. rCRS is widely used in population genetics. However, the official GRCh37 comes with a mitochondrial sequence 2bp longer than rCRS. If you want to analyze mitochondrial phylogeny, this 2bp insertion will cause troubles. GRCh38 uses rCRS.</p></li>
<li><p>Converting semi-ambiguous IUB codes to “N”. This is a very minor issue, though. Human chromosomal sequences contain few semi-ambiguous bases.</p></li>
<li><p>Using accession numbers instead of chromosome names. Do you know CM000663.2 corresponds to chr1 in GRCh38?</p></li>
<li><p>Not including unplaced and unlocalized contigs. This will force reads originated from these contigs to be mapped to the chromosomal assembly and lead to false variant calls.</p></li>
</ol>
<p>Now we can explain what is wrong with other versions of human reference genomes:</p>
<ul>
<li>hg19/chromFa.tar.gz from UCSC: 1, 3, 4 and 5.</li>
<li>hg38/hg38.fa.gz from UCSC: 1, 3 and 5.</li>
<li>GCA_000001405.15_GRCh38_genomic.fna.gz from NCBI: 1, 3, 5 and 6.</li>
<li>Homo_sapiens.GRCh38.dna.primary_assembly.fa.gz from EnsEMBL: 3.</li>
<li>Homo_sapiens.GRCh38.dna.toplevel.fa.gz from EnsEMBL: 1, 2 and 3.</li>
</ul>
<p>Using an impropriate human reference genome is usually not a big deal unless you study regions affected by the issues. However, 1) other researchers may be studying in these biologically interesting regions and will need to redo alignment; 2) aggregating data mapped to different versions of the genome will amplify the problems. It is still preferable to choose the right genome version if possible.</p>
<p><a href="https://lh3.github.io/2017/11/13/which-human-reference-genome-to-use" class="uri">https://lh3.github.io/2017/11/13/which-human-reference-genome-to-use</a></p>
</div>
<div id="section-4.1.2" class="section level3">
<h3><span class="header-section-number">4.1.2</span> 构建索引</h3>
<pre><code>### Bowtie
bowtie2-build --threads 10 hg19.fa hg19
### BWA
bwa index -a bwtsw -p hg19 hg19.fa
### STAR
STAR --runThreadN 10 --runMode genomeGenerate --genomeDir star_index --genomefastafiles hg19.fa --sjdbGTFfile hg19_genecode.gtf
### HISAT2
hisat2-build -p 20 hg19.fa hg19 --ss hg19.ss --exon hg19.exon </code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="biodata.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="art-of-ctrl-c-and-ctrl-v.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": true,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/lemonbases/scRNA.seq.course.CN/edit/master/04tools.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Binformatics_in_Action.pdf"],
"toc": {
"collapse": "section"
},
"search": true
});
});
</script>

</body>

</html>
